import {Manifest} from 'release-please/build/src/manifest'
import {useInputs} from './inputs'

export async function manifestInstance(github) {
	const {
		alwaysLinkLocal,
		bootstrapSha,
		bumpMinorPreMajor,
		bumpPatchForMinorPreMajor,
		changelogHost,
		changelogPath,
		changelogSections,
		changelogType,
		commitSearchDepth,
		component,
		draft,
		draftPullRequest,
		extraFiles,
		fork,
		groupPullRequestTitlePattern,
		includeVInTag,
		labels,
		lastReleaseSha,
		monorepoTags,
		packageName,
		path,
		plugins,
		prerelease,
		pullRequestTitlePattern,
		releaseAs,
		releaseLabels,
		releaseSearchDepth,
		releaseType,
		separatePullRequests,
		sequentialCalls,
		signoff,
		skipGithubRelease,
		skipLabeling,
		snapshotLabels,
		tagSeparator,
		versionFile,
		versioning
	} = useInputs()
	return await Manifest.fromConfig(github,
		github.repository.defaultBranch,
		{
			bumpMinorPreMajor,
			bumpPatchForMinorPreMajor,
			packageName,
			releaseType,
			changelogPath,
			changelogHost,
			changelogSections,
			versionFile,
			extraFiles,
			includeComponentInTag: monorepoTags,
			pullRequestTitlePattern,
			draftPullRequest,
			versioning,
			releaseAs,
			skipGithubRelease,
			draft,
			prerelease,
			component,
			includeVInTag,
			tagSeparator,
			changelogType,
			snapshotLabels
		},
		{
			draft,
			signoff,
			fork,
			draftPullRequest,
			bootstrapSha,
			lastReleaseSha,
			alwaysLinkLocal,
			separatePullRequests,
			plugins,
			labels,
			releaseLabels,
			snapshotLabels,
			skipLabeling,
			sequentialCalls,
			prerelease,
			groupPullRequestTitlePattern,
			releaseSearchDepth,
			commitSearchDepth
		},
		path)
}
